webpackJsonp([19],{"3uCk":function(t,e){},SUyR:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADqADAAQAAAABAAAADgAAAAC98Dn6AAABbUlEQVQoFZ1SvUrDUBTujUmopSqIIlhwdHJwcXIJuvoERZEkNXkBwUUcxEHwATQ/GIKP4Av0FYpj3aLiUs0U0vz6nVBLSDL1wOF85+e795x7Lms1iG3bZ2maXiPV4TjOHQwGN4yxrFzKlx3CpmkeZFnmovAB7hfwHWKfwI+U/xfmOE47juOLPM8ZBUE4Bj4EvJ0VnSPGAT+Tj1wO88Isy9oCfoNuouAHNqGCBiHyBnSC9o+KW1zX7YVh+CGK4q4sy+MGUgtzr2PuCc/z+6qqjmozGoaxhgOmgiDAiHG32808z2tXD6sR0e59FEXv0J0gCL593w9A2oNelck1IpKditKDLZdJhGnghWRhYq1VrMNHC79ob3WGaUYfj8XwqvPuCiJWMaUIHmQF5lLTtGQ4HC5JkkTfLMfP4fFJtqkmSZKittgjBZCk/Y2gT+RXBbf30cUJbE/X9XjeKhZ7ilNtJF+rJPIR91DTVxQlJv8P3z6Zosx3/c4AAAAASUVORK5CYII="},lfVf:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADqADAAQAAAABAAAADgAAAAC98Dn6AAABSElEQVQoFX2QvUoDURCFzw2roAg+hGBAUBBLETGFrRgUG9FOWzdEC7HYyk7TW/gCggS0ErGxE6zstBK1SxGrSPwZv5tdko3JOpcZ5sycw8xcKctCO1Bo51ntXFaD+mTifSn/CR2KzH5mA5H1HZUUY2Fom9wz94foJ3bbnuXh7cvMxUJTEcY1xaVuZgqVbUpN3VLZ0omCWDiodRa7w8+0YyspepyWbFpfugE08IK23WdnnchG9K5LGrN8yYZ+tEw+g6/hV3id+oKO3DO5OkKPIhtGfMHkeVAdH4BhvFpLdOxePM1bt9BXQhsiViEvegjjkVhQxb21cBJy3PSgkq22ixXX0Kj8J1UR3StgelrkuWgCmhOQxttCn0Tug+hv7DVTHs1YQKfGWkVWfOWOZi8zVTFuNvlfb/iJu4BDwKm+QVnmP8mb6QlW+RcweluVRfJJ8wAAAABJRU5ErkJggg=="},qDTc:function(t,e){},tZ8D:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("PJh5"),o=a.n(s),n=a("5Xf9"),i={name:"sandbox",data:function(){return{loading:!0,activeName:"first",options:{target:"/yiiapi/sandbox/upload",chunkSize:"10048000",testChunks:!1,parseTimeRemaining:function(t,e){return e.replace(/\syears?/,"年").replace(/\days?/,"天").replace(/\shours?/,"小时").replace(/\sminutes?/,"分钟").replace(/\sseconds?/,"秒")}},fileStatusText:{success:"成功",error:"错误",uploading:"上传中",paused:"暂停",waiting:"等待"},sandbox_list:{},sandbox_data:{page:1,rows:10}}},created:function(){this.get_version()},mounted:function(){this.get_data(),this.test(),this.check_passwd()},methods:{test:function(){this.$axios.get("/yiiapi/sandbox/list",{params:{pathInfo:"investigate/host-network-investigation"}}).then(function(t){}).catch(function(t){console.log(t)})},check_passwd:function(){var t=this;this.$axios.get("/yiiapi/site/check-passwd-reset").then(function(e){var a=e.data,s=a.status,o=a.msg;a.data;if(0!=s)for(var i in o)600==i&&t.$message({message:o[i],type:"warning"}),602==i&&(t.$message({message:o[i],type:"warning"}),n.a.$emit("reset"))})},get_version:function(){var t=this;this.$axios.get("/yiiapi/site/license-version").then(function(e){var a=e.data,s=(a.status,a.data);console.log(s),t.loading=!1,1==s.edition&&t.$router.push({path:"/401"})}).catch(function(t){console.log(t)})},onFileAdded:function(t){console.log(t),t.pause(),t.size>104857600?(this.$message({message:"上传文件大小不能超过 100MB!",type:"warning"}),setTimeout(function(){t.cancel()},100)):setTimeout(function(){t.resume()},100)},onFileSuccess:function(t,e,a,s){var o=this;this.$axios.get("/yiiapi/site/check-auth-exist",{params:{pathInfo:"yararule/download"}}).then(function(t){}).catch(function(t){console.log(t)}),0==JSON.parse(a).status?(console.log(e),this.$axios.get("/yiiapi/sandbox/move-file",{params:{upload_name:e.name}}).then(function(t){var a=t.data,s=a.status;a.data;0==s?(e.cancel(),o.get_data(),o.$message({message:"上传成功!",type:"success"})):o.$message({message:t.data.msg,type:"error"})}).catch(function(t){console.log(t)})):this.$message({message:JSON.parse(a).msg,type:"error"}),console.log(s)},onFileProgress:function(t){this.$axios.get("/yiiapi/site/check-auth-exist",{params:{pathInfo:"yararule/download"}}).then(function(t){}).catch(function(t){console.log(t)})},onFileError:function(){this.$axios.get("/yiiapi/site/check-auth-exist",{params:{pathInfo:"yararule/download"}}).then(function(t){}).catch(function(t){console.log(t)})},get_data:function(){var t=this;this.$axios.get("/yiiapi/sandbox/list",{params:{page:this.sandbox_data.page,rows:this.sandbox_data.rows}}).then(function(e){var a=e.data,s=a.status,o=a.data;0==s&&(t.sandbox_list=o,t.sandbox_list.data.forEach(function(t,e){switch(t.result){case"0":t.result_cn="发现威胁";break;case"1":t.result_cn="未发现威胁";break;case"2":t.result_cn=""}})),console.log(e)}).catch(function(t){console.log(t)})},download:function(t){this.$axios.get("/yiiapi/site/check-auth-exist",{params:{pathInfo:"yararule/download"}}).then(function(e){var a="/yiiapi/sandbox/download-file?id="+t.id;window.location.href=a}).catch(function(t){console.log(t)}),console.log(t)},del_box:function(t){var e=this;this.$confirm("此操作删除信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.delete("/yiiapi/sandbox/del",{data:{id:t.id}}).then(function(t){var a=t.data,s=a.status;a.data;0==s?(e.get_data(),e.$message({message:"删除成功!",type:"success"})):e.$message({message:"删除失败!",type:"error"})}).catch(function(t){console.log(t)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(t){this.sandbox_data.rows=t,this.sandbox_data.page=1,this.get_data()},handleCurrentChange:function(t){this.sandbox_data.page=t,this.get_data()}},filters:{formatDate:function(t){return o()(t).format("YYYY-MM-DD HH:mm:ss")}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"sandbox"}},[s("div",{staticClass:"container"},[s("div",{staticClass:"invest_box"},[s("el-tabs",{staticClass:"reset_tab",model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{staticClass:"tabs-item",attrs:{label:"沙箱",name:"first"}},[s("div",{staticClass:"top"},[s("uploader",{staticClass:"uploader-example",attrs:{options:t.options,autoStart:!1,fileStatusText:t.fileStatusText},on:{"file-added":t.onFileAdded,"file-success":t.onFileSuccess,"file-progress":t.onFileProgress,"file-error":t.onFileError}},[s("uploader-unsupport"),t._v(" "),s("img",{staticClass:"upload_img",attrs:{src:a("8BA2"),alt:""}}),t._v(" "),s("uploader-drop",[s("uploader-btn",{staticClass:"select_btn"},[t._v("点击上传")]),t._v(" "),s("span",[t._v("请选择需要扫描上传的文件(最大100M)")])],1),t._v(" "),s("uploader-list")],1)],1),t._v(" "),s("div",{staticClass:"sandbox_table"},[s("el-table",{ref:"multipleTable",staticClass:"reset_table",staticStyle:{width:"100%"},attrs:{align:"center",border:"",data:t.sandbox_list.data,"tooltip-effect":"dark"}},[s("el-table-column",{attrs:{label:"结果",align:"center",width:"160","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{class:0==e.row.result?"color_red":""},[t._v(t._s(e.row.result_cn))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"创建时间",align:"center",width:"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("formatDate")(1e3*e.row.created_at)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"扫描状态",align:"center",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s("1"==e.row.status?"扫描中":"扫描结束"))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"upload_name",align:"center",label:"文件名","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{label:"扫描详情",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[1!=e.row.status&&0==e.row.result?s("img",{staticClass:"img_icon",attrs:{src:a("lfVf"),alt:""},on:{click:function(a){return a.stopPropagation(),t.download(e.row)}}}):t._e()]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[1!=e.row.status?s("img",{staticClass:"img_icon",attrs:{src:a("SUyR"),alt:""},on:{click:function(a){return a.stopPropagation(),t.del_box(e.row)}}}):t._e()]}}])})],1),t._v(" "),s("el-pagination",{staticClass:"pagination_box",attrs:{"current-page":t.sandbox_list.pageNow,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next",total:t.sandbox_list.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1)],1)])])},staticRenderFns:[]};var c=a("VU/8")(i,l,!1,function(t){a("3uCk"),a("qDTc")},"data-v-d59f9444",null);e.default=c.exports}});